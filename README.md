# Predicting-the-Next-Word-using-LSTM-and-GRU

This project is about predicting the next word from a text dataset using LSTM and GRU architecture. The dataset used here is Shakespeare's Hamlet that is downloaded using NLTK. You will be able to see this at the start of the Jupyter Notebook files named ``` experiments#.ipynb ```. 

There are two ```experiment#.ipynb ``` files. In each of the Jupyter Notebook file, different techniques are used. 
```experiment1.ipynb``` uses the **LSTM** structure and ```experiment2.ipynb``` uses the **GRU** structure. Inside each file, you will see all the techniques I used for predicting the next word. You will see there is a dataset called **hamlet.txt**. You can choose to delete this dataset if you choose to follow the exact codes I wrote in Jupyter Notebook files. 

This is because at the start of the code in the first cell, you will be able to see I downloaded the dataset using NLTK library. So when you run the first cell, the dataset will be downloaded in your local machine as well. Just like the Jupyter Notebook files, you will also find that there are 2 python applications for deploying the program on streamlit: 

```app1.py``` is used for the **LSTM** structure and  ```app2.py``` is used for the **GRU** structure. You have to ensure that you use each combination of the files respectively. 
For example: If you are using the **LSTM** structure, then run ```experiment1.ipynb``` and ```app1.py```. Similarly, for **GRU**, you will have to use ```experiment2.ipynb``` and ```app2.py```. 
The contents are almost the same for either one, except for the techniques. You can find the differences by yourself once you see both the files. 

The ```tokenizer.pkl``` is the same so if you run either one, you will see inside that there is a code for creating the tokenizer file. 

I also uploaded my trained models which are the ```.h5``` files. These models are ran on 100 epochs and trained to give an accuracy of **75% - 78%**. However, I suggest you try training the models on your own using your local machine and play with the epochs for a better accuracy. You should try training for more than 100 epochs and you will likely get more than **80%** accuracy. If you train your own model(which is highly recommended), please remove my trained models to avoid confusion. Alternatively, you can choose to name your model something different as well to avoid confusion.


This repository and its contents are free to use and you can download or fork the repository at will! If you want to run this in your local machine, I suggest you create a virtual environment and try this inside that environment to avoid conflict between versions. 


# Installing Necessary Libraries
Before running anything in your local machine, first you need to ensure you have all the libraries and packages downloaded. You can do that using the terminal or command prompt in your IDE and simply run ``` pip install -r requirements.txt ``` and all the necessary libraries and packages should be installed. Do this part after creating the virtual environment. 

# Virtual Environments

Refer to [Python documentation](https://docs.python.org/3.12/library/venv.html) for more information about virtual environments.

To create a virtual environment, go to your projectâ€™s directory and run the following command:  
```
 python3 -m venv .venv
```
This will create a new virtual environment in a local folder named **.venv**

Activate your virtual environment using: 
```
 source .venv/bin/activate
```

To deactivate a virtual environment, simply type deactivate and your virtual environment should be deactivated.
```
 deactivate 
```

# [Deployment on Streamlit](https://docs.streamlit.io/)

This program is also deployed on Streamlit Community domain. You can also modify the **app#.py** file to edit how you want your system to look like on the Streamlit web domain. I used a very simplistic approach for my web app have not edited or added much visuals. You can edit this however you want by referring to the streamlit guide.  If you want to see this model running as a web app, you can do so by running **app#.py** in your terminal using the following command: 
```
streamlit run app#.py
```
Once you run this code in your terminal or command prompt, the app should run and a browser window should pop up taking you to the address of this app generated by Streamlit. You can also access the web app (while it is running) from the address that is shown in the terminal. 
For your clarification: Closing the browser window or tab does not necessarily close the web app. To close it properly, go to your terminal(from where you ran the streamlit app) and press <ins>CTRL+C</ins>. 
